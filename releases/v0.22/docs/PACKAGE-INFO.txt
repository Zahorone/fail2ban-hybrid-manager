â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                                                                â•‘
â•‘    Fail2Ban + nftables v0.21 - ShellCheck Compliance Release   â•‘
â•‘      Complete IPv4 + IPv6 Dual-Stack Security System           â•‘
â•‘                                                                â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

VERSION: 0.21
RELEASE DATE: December 2025
LICENSE: MIT

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
PACKAGE CONTENTS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“¦ TOTAL FILES: 29

INSTALLER:
  âœ… INSTALL-ALL-v021.sh              Universal installer (auto-detect upgrade)

SCRIPTS (9):
  âœ… 00-pre-cleanup-v021.sh           Pre-installation cleanup & backup
  âœ… 01-install-nftables-v021.sh      nftables infrastructure (IPv4+IPv6)
  âœ… 02-install-jails-v021.sh         Jail + filter installer (automatic)
  âœ… 02-verify-jails-v021.sh          Jail verifier (diagnostic tool)
  âœ… 03-install-docker-block-v03.sh   Docker port blocking v0.3
  âœ… 04-install-wrapper-v021.sh       F2B wrapper installer
  âœ… 05-install-auto-sync.sh          Auto-sync service (hourly)
  âœ… 06-install-aliases.sh            Bash aliases
  âœ… f2b-wrapper-v021.sh              Main wrapper (43 functions, 1060 lines)

FILTERS (10):
  âœ… sshd.conf                        SSH brute-force (multi-mode)
  âœ… f2b-exploit-critical.conf        Critical CVE exploits
  âœ… f2b-dos-high.conf                DoS/DDoS attacks
  âœ… f2b-web-medium.conf              SQL injection, path traversal
  âœ… nginx-recon-optimized.conf       Nginx reconnaissance
  âœ… f2b-fuzzing-payloads.conf        Fuzzing detection
  âœ… f2b-botnet-signatures.conf       Botnet signatures
  âœ… f2b-anomaly-detection.conf       Anomaly patterns
  âœ… manualblock.conf                 Manual IP banning
  âœ… recidive.conf                    Repeat offenders

CONFIGURATION (2):
  âœ… jail.local                       10 jails configuration
  âœ… nginx-recon-optimized.local      Nginx jail config

DOCUMENTATION (4):
  âœ… README.md                        Complete usage guide
  âœ… CHANGELOG.md                     Version history
  âœ… MIGRATION-GUIDE.md               v0.20 â†’ v0.21 upgrade guide
  âœ… PACKAGE-INFO.txt                 This file

ADDITIONAL:
  âœ… LICENSE                          MIT License
  âœ… .gitignore                       Git ignore rules

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
FEATURES
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ›¡ï¸  INFRASTRUCTURE:
  â€¢ Full IPv4 + IPv6 dual-stack support
  â€¢ 20 nftables sets (10 IPv4 + 10 IPv6)
  â€¢ 20 INPUT rules (10 + 10)
  â€¢ 6 FORWARD rules (3 + 3)

ğŸš¨ DETECTION:
  â€¢ 10 Fail2Ban jails with optimized triggers
  â€¢ 10 advanced detection filters
  â€¢ Multi-layered threat detection
  â€¢ Automatic IP banning

ğŸ”§ MANAGEMENT:
  â€¢ F2B Wrapper v0.21 with 43 functions
  â€¢ Core: status, audit, find, version
  â€¢ Sync: check, enhanced, force, silent
  â€¢ Manage: ports, IPs, reload, backup
  â€¢ Monitor: watch, trends, top-attackers, jail-log
  â€¢ Reports: JSON, CSV, daily

ğŸ‹ DOCKER INTEGRATION:
  â€¢ Docker port blocking v0.3
  â€¢ External access blocking (localhost allowed)
  â€¢ Dynamic port management

âš™ï¸  AUTOMATION:
  â€¢ Auto-sync service (hourly)
  â€¢ Silent operations for cron
  â€¢ Bash aliases for quick access
  â€¢ Persistent logging

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
INSTALLATION
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

QUICK START (3 steps):

1. Extract package:
   tar -xzf fail2ban-nftables-v021-production.tar.gz
   cd fail2ban-nftables

2. Run installer:
   chmod +x INSTALL-ALL-v021.sh
   sudo bash INSTALL-ALL-v021.sh

3. Verify:
   sudo f2b status
   sudo nft list chain inet fail2ban-filter f2b-input | grep -c drop
   # Expected: 20

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
UPGRADE FROM v0.19/v0.20
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Automatic upgrade detection:
  sudo bash INSTALL-ALL-v021.sh

The installer auto-detects v0.19 and adds IPv6 support without
affecting existing IPv4 bans.

See docs/MIGRATION-GUIDE.md for detailed upgrade instructions.

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ADVANCED: MANUAL CONFIGURATION
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

For production servers with custom requirements:

1. Edit configuration:
   nano config/jail.local           # Customize settings
   nano filters/*.conf              # Adjust patterns

2. Manual installation:
   sudo cp config/jail.local /etc/fail2ban/
   sudo cp config/nginx-recon-optimized.local /etc/fail2ban/jail.d/
   sudo cp filters/*.conf /etc/fail2ban/filter.d/
   sudo systemctl restart fail2ban

3. Verification:
   sudo bash scripts/02-verify-jails-v021.sh

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
TWO-SCRIPT APPROACH
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

02-install-jails-v021.sh:
  â€¢ Full automated installer
  â€¢ Copies jail.local to /etc/fail2ban/
  â€¢ Copies ALL 10 filters to /etc/fail2ban/filter.d/
  â€¢ Validates configuration
  â€¢ Restarts Fail2Ban
  â€¢ Used by INSTALL-ALL-v020.sh

02-verify-jails-v021.sh:
  â€¢ Diagnostic verification tool
  â€¢ Non-invasive (read-only)
  â€¢ Checks banaction configuration
  â€¢ Validates nftables integration
  â€¢ Reports configuration status
  â€¢ Used for troubleshooting

Use case:
  â€¢ Automatic install â†’ 02-install-jails-v021.sh
  â€¢ Manual config + verify â†’ 02-verify-jails-v021.sh

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
SYSTEM REQUIREMENTS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

REQUIRED:
  â€¢ Ubuntu 20.04 LTS or newer (recommended: 22.04/24.04)
  â€¢ Root/sudo access
  â€¢ nftables support (kernel 4.18+)
  â€¢ fail2ban (installed automatically if missing)

OPTIONAL:
  â€¢ Docker (for docker-block functionality)
  â€¢ IPv6 enabled (for IPv6 protection)

TESTED ON:
  â€¢ Ubuntu 24.04 LTS âœ…
  â€¢ Ubuntu 22.04 LTS âœ…
  â€¢ Ubuntu 20.04 LTS âœ…
  â€¢ Debian 12 âœ…

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
F2B WRAPPER USAGE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

CORE COMMANDS:
  sudo f2b status                    System overview
  sudo f2b audit                     Audit all jails
  sudo f2b find <IP>                 Find IP in jails
  sudo f2b version                   Version info

SYNC:
  sudo f2b sync check                Verify F2B â†” nftables sync
  sudo f2b sync force                Force bidirectional sync

MANAGE - PORTS:
  sudo f2b manage block-port 8081    Block Docker port
  sudo f2b manage unblock-port 8081  Unblock port
  sudo f2b manage list-blocked-ports

MANAGE - IPS:
  sudo f2b manage manual-ban <IP> [time]
  sudo f2b manage manual-unban <IP>

MONITOR:
  sudo f2b monitor watch              Real-time monitoring
  sudo f2b monitor trends             Attack trend analysis
  sudo f2b monitor top-attackers      Top 10 attackers
  sudo f2b monitor jail-log <jail>    Jail-specific logs

REPORTS:
  sudo f2b report json > report.json
  sudo f2b report csv > report.csv
  sudo f2b report daily

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
TROUBLESHOOTING
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1. Run diagnostic tool:
   sudo bash scripts/02-verify-jails-v020.sh

2. Check logs:
   sudo tail -100 /var/log/fail2ban.log
   sudo tail -50 /var/log/f2b-wrapper.log

3. Verify infrastructure:
   sudo nft list table inet fail2ban-filter
   sudo fail2ban-client status

4. Force sync:
   sudo f2b sync force

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
SUPPORT & DOCUMENTATION
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Full Documentation:
  â€¢ README.md              Complete usage guide
  â€¢ CHANGELOG.md           Version history
  â€¢ MIGRATION-GUIDE.md     Upgrade instructions

GitHub:
  â€¢ Issues: Bug reports and feature requests
  â€¢ Pull Requests: Contributions welcome

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
VERSION COMPARISON
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

                        v0.18    v0.19    v0.20/v0.21
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
IPv4 Support            âœ…       âœ…       âœ…
IPv6 Support            âŒ       âŒ       âœ…
nftables Sets           10       10       20
INPUT Rules             10       10       20
FORWARD Rules           3        3        6
Fail2Ban Jails          10       10       10
Detection Filters       10       10       10
F2B Wrapper Functions   35       43       43
Lock Mechanism          âŒ       âœ…       âœ…
Attack Trends           âŒ       âœ…       âœ…
JSON/CSV Export         âŒ       âœ…       âœ…
Dual Install Scripts    âŒ       âŒ       âœ…
Universal Installer     âŒ       âŒ       âœ…
Auto-Upgrade Detection  âŒ       âŒ       âœ…

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
CHANGELOG HIGHLIGHTS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

v0.20/v0.21 (2025-12-04):
  âœ… Full IPv6 support added
  âœ… 20 nftables sets (10 IPv4 + 10 IPv6)
  âœ… 20 INPUT rules, 6 FORWARD rules
  âœ… Universal installer with auto-upgrade detection
  âœ… Dual installation scripts (install + verify)
  âœ… Advanced manual configuration workflow
  âœ… Complete documentation update

v0.19 (2025-12):
  âœ… Lock mechanism
  âœ… Attack trend analysis
  âœ… JSON/CSV export
  âœ… Enhanced monitoring

v0.18 (2025-11):
  âœ… Initial release
  âœ… 10 jails + 10 filters
  âœ… F2B wrapper (35 functions)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
LICENSE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

MIT License

Copyright (c) 2025

Permission is hereby granted, free of charge, to any person obtaining
a copy of this software and associated documentation files (the
"Software"), to deal in the Software without restriction, including
without limitation the rights to use, copy, modify, merge, publish,
distribute, sublicense, and/or sell copies of the Software, and to
permit persons to whom the Software is furnished to do so, subject to
the following conditions:

The above copyright notice and this permission notice shall be included
in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS
OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Package generated: December 2025
Production Ready: âœ…
Full IPv4 + IPv6 Support: âœ…
Complete Documentation: âœ…
