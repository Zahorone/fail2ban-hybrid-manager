# Fail2Ban Hybrid Manager v0.33
# Fail2Ban Filter: recidive.conf
# Date: 2026-01-01
# Managed by: INSTALL-ALL-v033 bundle

# Fail2Ban recidive filter - FIXED (ignore Restore Ban)
# Detects IPs banned multiple times across all jails
#
# Author: Airway (2025-12-17)
# Fixed: Ignores "Restore Ban" (fail2ban restarts)

[INCLUDES]
before = common.conf

[Definition]

# Match only real bans, NOT "Restore Ban"
# Real ban:    NOTICE [jail] Ban IP
# Restore ban: NOTICE [jail] Restore Ban IP  ‚Üê IGNORE THIS!
#
failregex = ^\s*fail2ban\.actions\s*\[\d+\]:\s*(NOTICE|WARNING|INFO)\s*\[\S+\]\s+Ban\s+<HOST>\s*$

# Ignore "Restore Ban" events (fail2ban restarts)
ignoreregex = ^\s*fail2ban\.actions\s*\[\d+\]:\s*(NOTICE|WARNING|INFO)\s*\[\S+\]\s+Restore\s+Ban

[Init]
journalmatch = _SYSTEMD_UNIT=fail2ban.service