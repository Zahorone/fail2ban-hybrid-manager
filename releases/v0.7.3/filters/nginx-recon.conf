# NGINX Proxy Manager - Recon/Sensitive Files Filter
# NPM Log Format: [Date] - Code - METHOD SCHEME DOMAIN "PATH" [Client IP] ...

[Definition]

failregex = ^.* GET https [^ ]+ "/[^"]*\.git/[^"]*" \[Client <HOST>\]
            ^.* GET https [^ ]+ "/[^"]*\.gitignore" \[Client <HOST>\]
            ^.* GET https [^ ]+ "/[^"]*\.git/config" \[Client <HOST>\]
            ^.* GET https [^ ]+ "/[^"]*\.npmrc" \[Client <HOST>\]
            ^.* GET https [^ ]+ "/[^"]*\.env(?:\.backup|\.prod|\.local|\.test)?(?:"|$)" \[Client <HOST>\]
            ^.* GET https [^ ]+ "/(?:composer\.lock|package-lock\.json|yarn\.lock)" \[Client <HOST>\]
            ^.* GET https [^ ]+ "/[^"]*\.(?:bak|backup|old|save|swp)" \[Client <HOST>\]
            ^.* GET https [^ ]+ "/[^"]*~" \[Client <HOST>\]
            ^.* GET https [^ ]+ "/[^"]*\.sql" \[Client <HOST>\]
            ^.* GET https [^ ]+ "/[^"]*(?:dump|backup|database)\.sql" \[Client <HOST>\]
            ^.* GET https [^ ]+ "/\.DS_Store" \[Client <HOST>\]
            ^.* GET https [^ ]+ "/\.htaccess" \[Client <HOST>\]
            ^.* GET https [^ ]+ "/(?:phpinfo|info|test)\.php" \[Client <HOST>\]
            ^.* GET https [^ ]+ "/[^"]*wp-(?:admin|login)[^"]*" \[Client <HOST>\]
            ^.* GET https [^ ]+ "/[^"]*wp-config\.php" \[Client <HOST>\]
            ^.* GET https [^ ]+ "/(?:admin(?:\.php|istrator)?|manage)" \[Client <HOST>\]
            ^.* GET https [^ ]+ "/[^"]*(?:config|configuration|settings|db_config)\.php" \[Client <HOST>\]
            ^.* GET https [^ ]+ "/[^"]*(?:shell|cmd|backdoor|c99|r57)\.php" \[Client <HOST>\]
            ^.* GET https [^ ]+ "/[^"]*\.(?:sh|py|pl)" \[Client <HOST>\]
            ^.* GET https [^ ]+ "/(?:backup|dump|private|secret|\.git)/" \[Client <HOST>\]
            ^.* GET https [^ ]+ "/api/(?:\.env|config)" \[Client <HOST>\]

ignoreregex = 
