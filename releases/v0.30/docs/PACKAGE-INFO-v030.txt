â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                                                                â•‘
â•‘    Fail2Ban + nftables v0.30 - Production Bundle               â•‘
â•‘      One-Click IPv4 + IPv6 + Docker-Block Security System      â•‘
â•‘                                                                â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

VERSION: 0.30
RELEASE DATE: December 19, 2025
UPGRADE FROM: v0.19â€“v0.24 (auto-detect)
LICENSE: MIT


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
KEY CHANGES IN v0.30
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸš€ ONE-CLICK INSTALLER:
  âœ… New universal installer: INSTALL-ALL-v030.sh
     â€¢ Detects fresh install / upgrade / reinstall
     â€¢ Orchestrates all components (nftables, jails, wrapper, docker-block)
     â€¢ Safe pre-cleanup + full backup before changes
  âœ… --cleanup-only mode:
     â€¢ Runs 00-pre-cleanup-v030.sh only
     â€¢ No firewall/jail modifications
     â€¢ Ideal for first test on production

ğŸ§© CONSOLIDATED v0.30 STRUCTURE:
  âœ… Finalized nftables layout:
     â€¢ 11 IPv4 sets + 11 IPv6 sets (f2b-*)
     â€¢ 22 INPUT rules (11 IPv4 + 11 IPv6)
     â€¢ 6 FORWARD rules (backend protection)
  âœ… 11 Fail2Ban jails + 11 detection filters:
     â€¢ sshd, sshd-slowattack
     â€¢ f2b-exploit-critical, f2b-dos-high, f2b-web-medium
     â€¢ nginx-recon-bonus, recidive, manualblock
     â€¢ f2b-fuzzing-payloads, f2b-botnet-signatures, f2b-anomaly-detection

ğŸ“Š WRAPPER v0.30 (50+ FUNCTIONS):
  âœ… Enhanced reporting & analysis:
     â€¢ f2b report attack-analysis
     â€¢ --npm-only / --ssh-only modes
  âœ… Improved sync & monitoring:
     â€¢ f2b sync check/enhanced/force/silent/docker
     â€¢ f2b monitor watch/top-attackers/trends/jail-log
  âœ… ShellCheck-clean code:
     â€¢ Fixed SC2034/SC2086/SC2126/SC2155/SC2188/SC1083
     â€¢ Unified metadata header (RELEASE/VERSION/BUILD_DATE/COMPONENT_NAME)

ğŸ‹ DOCKER-BLOCK v0.4 + AUTO-SYNC:
  âœ… docker-block table (inet docker-block):
     â€¢ docker-blocked-ports (service ports)
     â€¢ docker-banned-ipv4 / docker-banned-ipv6
  âœ… Auto-sync:
     â€¢ Systemd service for Fail2Ban â†” nftables sync
     â€¢ Cron job: every minute docker sync
  âœ… Wrapper commands:
     â€¢ f2b docker dashboard / info / sync
     â€¢ f2b manage block-port / unblock-port / list-blocked-ports

ğŸ§¹ SAFE PRE-CLEANUP:
  âœ… 00-pre-cleanup-v030.sh:
     â€¢ Backups: nftables ruleset + fail2ban configs
     â€¢ Cleanup legacy systemd units, cron entries, aliases
     â€¢ FORCE cleanup (optional) for full reinstall
     â€¢ VERIFICATION snapshot at the end (tables, units, cron)


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
PACKAGE CONTENTS (v0.30)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“¦ ROOT:
  âœ… INSTALL-ALL-v030.sh              Universal installer (one-click)
  âœ… README-v030.md                   Main usage guide
  âœ… CHANGELOG-v030.md                Version history
  âœ… MIGRATION-GUIDE.md               Upgrade instructions (v0.19â€“v0.24 â†’ v0.30)
  âœ… PACKAGE-INFO-v030.txt            This file

ğŸ“‚ scripts/ (core logic):
  âœ… 00-pre-cleanup-v030.sh           Pre-install cleanup, backup, legacy removal
  âœ… 01-install-nftables-v030.sh      nftables infrastructure (11+11 sets, 22+6 rules)
  âœ… 02-install-jails-v030.sh         Jails + filters + actions installer
  âœ… 02-verify-jails-v030.sh          Post-install verifier (banactions, timeouts)
  âœ… 03-install-docker-block-v030.sh  Docker port + IP blocking (v0.4)
  âœ… 04-install-wrapper-v030.sh       F2B wrapper installer (v0.30)
  âœ… 05-install-auto-sync-v030.sh     Auto-sync service (Fail2Ban â†” nftables)
  âœ… 06-install-aliases-v030.sh       Minimal f2b-* aliases (optional)
  âœ… 07-setup-docker-sync-cron-v030.sh Docker-block sync cron (every minute)
  âœ… f2b-wrapper-v030.sh              Main wrapper (50+ functions)

ğŸ“‚ filters/ (11 detection filters):
  âœ… sshd.conf                        SSH brute-force (multi-mode)
  âœ… f2b-exploit-critical.conf        Critical exploit scanners
  âœ… f2b-dos-high.conf                DoS/DDoS patterns
  âœ… f2b-web-medium.conf              Web attacks (SQLi, path traversal, etc.)
  âœ… nginx-recon-optimized.conf       Nginx reconnaissance
  âœ… f2b-fuzzing-payloads.conf        Fuzzing payloads
  âœ… f2b-botnet-signatures.conf       Botnet/scanner signatures
  âœ… f2b-anomaly-detection.conf       Anomaly patterns
  âœ… manualblock.conf                 Manual IP banning
  âœ… recidive.conf                    Recidive jail (30d ban)
  âœ… sshd-slowattack filter           (included in sshd.conf)

ğŸ“‚ config/ (custom config):
  âœ… jail.local                       11 jails (correct banaction mapping)
  âœ… nginx-recon-optimized.local      Filter extension (ignoreregex)
  âœ… f2b-anomaly-detection.local      Filter extension (ignoreregex)

ğŸ“‚ action.d/ (nftables actions):
  â­ nftables-common.local            Table override (inet fail2ban-filter) [CRITICAL]
  â­ nftables-multiport.conf          Generic 7d action (IPv4+IPv6)
  â­ nftables-recidive.conf           30d recidive action (FORWARD + INPUT)


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
UPGRADE PATHS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

FROM v0.19 / v0.20:
  âœ… Use MIGRATION-GUIDE (legacy) to reach v0.20/v0.22
  âœ… Then run v0.30 installer (INSTALL-ALL-v030.sh)
  âœ… Preserves all IPv4 bans, adds/maintains IPv6 structure

FROM v0.21 / v0.22 / v0.24:
  âœ… Directly run INSTALL-ALL-v030.sh
  âœ… Installer detects existing structure:
     â€¢ If IPv6 missing â†’ upgrade_old path
     â€¢ If full v0.22+ structure â†’ reinstall path
  âœ… All bans and core nftables structure preserved

CLEAN INSTALL (new server):
  âœ… INSTALL-ALL-v030.sh:
     â€¢ Creates full nftables + Fail2Ban + Docker-block + sync setup
     â€¢ Configures auto-sync + docker-block cron
     â€¢ Adds minimal wrapper aliases (optional)


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
QUICK VERIFY AFTER INSTALL (v0.30)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1) Check nftables structure
sudo nft list table inet fail2ban-filter

2) Check jails
sudo fail2ban-client status

3) Wrapper & sync
sudo f2b status
sudo f2b sync check
sudo f2b docker dashboard

4) Optional deep verify
sudo bash scripts/02-verify-jails-v030.sh

If all checks pass and counts match (11 sets v4, 11 sets v6, 22 INPUT, 6 FORWARD, 11 jails), your system is fully protected with the v0.30 bundle.

