# Fail2Ban Hybrid Manager v0.31
# Fail2Ban Filter: nginx-recon-optimized.conf
# Date: 2025-12-26
# Managed by: INSTALL-ALL-v031 bundle

[Definition]
failregex = ^.* GET (?:http|https) [^ ]+ "/[^"]*\.git/[^"]*" \[Client <HOST>\]
            ^.* GET (?:http|https) [^ ]+ "/[^"]*\.gitignore" \[Client <HOST>\]
            ^.* GET (?:http|https) [^ ]+ "/[^"]*\.git/config" \[Client <HOST>\]
            ^.* GET (?:http|https) [^ ]+ "/[^"]*\.npmrc" \[Client <HOST>\]
            ^.* GET (?:http|https) [^ ]+ "/[^"]*\.env.*" \[Client <HOST>\]
            ^.* GET (?:http|https) [^ ]+ "/[^"]*\.well-known" \[Client <HOST>\]
            ^.* GET (?:http|https) [^ ]+ "/[^"]*composer\.lock" \[Client <HOST>\]
            ^.* GET (?:http|https) [^ ]+ "/[^"]*package-lock\.json" \[Client <HOST>\]
            ^.* GET (?:http|https) [^ ]+ "/[^"]*yarn\.lock" \[Client <HOST>\]
            ^.* GET (?:http|https) [^ ]+ "/[^"]*\.bak" \[Client <HOST>\]
            ^.* GET (?:http|https) [^ ]+ "/[^"]*\.backup" \[Client <HOST>\]
            ^.* GET (?:http|https) [^ ]+ "/[^"]*\.old" \[Client <HOST>\]
            ^.* GET (?:http|https) [^ ]+ "/[^"]*\.sql" \[Client <HOST>\]
            ^.* GET (?:http|https) [^ ]+ "/[^"]*\.htaccess" \[Client <HOST>\]
            ^.* GET (?:http|https) [^ ]+ "/[^"]*config\.php" \[Client <HOST>\]
            ^.* GET (?:http|https) [^ ]+ "/phpinfo\.php" \[Client <HOST>\]
            ^.* GET (?:http|https) [^ ]+ "/wp-admin" \[Client <HOST>\]
            ^.* POST (?:http|https) [^ ]+ "/wp-json" \[Client <HOST>\]
            ^.* GET (?:http|https) [^ ]+ "/shell\.php" \[Client <HOST>\]
            ^.* GET (?:http|https) [^ ]+ "/cmd\.php" \[Client <HOST>\]
            ^.* GET (?:http|https) [^ ]+ "/backdoor\.php" \[Client <HOST>\]
            ^.* GET (?:http|https) [^ ]+ "/admin" \[Client <HOST>\]
            ^.* POST (?:http|https) [^ ]+ "/admin" \[Client <HOST>\]
            ^.* (400|401|403|404|429|444) .* \[Client <HOST>\]
            ^.* HEAD (?:http|https) [^ ]+ .* \[Client <HOST>\]

ignoreregex =