# Fail2Ban Hybrid Manager v0.31
# Fail2Ban Filter: f2b-fuzzing-payloads.conf
# Date: 2025-12-26
# Managed by: INSTALL-ALL-v031 bundle

# f2b-fuzzing-payloads.conf - Fuzzing & Random Payload Detection
# Detects: Path fuzzing with special chars, gibberish paths, random text
# Examples: /[hello.world]?, /test/random, /foo/bar, /~, /.
# Production Ready

[Definition]
failregex = ^.* (?:GET|POST) (?:http|https) [^ ]+ "/\[[^\]]*\].*" \[Client <HOST>\]
            ^.* (?:GET|POST) (?:http|https) [^ ]+ "/.*(?:hello|world|test|random|foo|bar|baz|admin|shell|cmd)[^"]*" \[Client <HOST>\]
            ^.* POST (?:http|https) [^ ]+ ".*hello world.*" \[Client <HOST>\]
            ^.* (?:GET|POST) (?:http|https) [^ ]+ "/(?:[a-z]{1,3}\.)?txt" \[Client <HOST>\]
            ^.* (?:GET|POST) (?:http|https) [^ ]+ "/\." \[Client <HOST>\]
            ^.* (?:GET|POST) (?:http|https) [^ ]+ "/~" \[Client <HOST>\]
            ^.* (?:GET|POST) (?:http|https) [^ ]+ "/\?" \[Client <HOST>\]
            ^.* (?:GET|POST) (?:http|https) [^ ]+ ".*%%2[ef].*" \[Client <HOST>\]

ignoreregex = ^.*booking/reschedule/.*$
              ^.*/assets/.*$
              ^.*index\.php.*$
              ^.*/static/.*$
